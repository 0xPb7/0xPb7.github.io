<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Klise Theme" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Klise Theme" /> <title> CSP-101 Part-3 - Klise Theme </title> <link rel="alternate" href="http://localhost:4000/CSP-101-Part-3/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/CSP-101-Part-3/" /> <meta name="description" content="He&#39;s writing in Bahasa about web technology and experience as a journal for documentation things that he learned, meet him @github." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="CSP-101 Part-3 | Prasanth Bodepu" /> <meta property="og:title" content="CSP-101 Part-3 | Prasanth Bodepu" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/CSP-101-Part-3/" /> <meta property="og:description" content="He&#39;s writing in Bahasa about web technology and experience as a journal for documentation things that he learned, meet him @github." /> <meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="CSP-101 Part-3 | 0xPb" /> <meta name="twitter:url" content="http://localhost:4000/CSP-101-Part-3/" /> <meta name="twitter:site" content="@0xPb" /> <meta name="twitter:creator" content="@0xPb" /> <meta name="twitter:description" content="He&#39;s writing in Bahasa about web technology and experience as a journal for documentation things that he learned, meet him @github." /> <meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Klise Theme" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- for mathjax support --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Home</a><a class="menu-link" href="/archive/">Blog</a><a class="menu-link" href="/tags/">Categories</a><a class="menu-link" href="/about/">About</a><a class="menu-link rss" target="_blank" href="https://app.hackthebox.com/users/605904"> <ion-icon name="cube-outline"></ion-icon> </a> <a class="menu-link rss" target="_blank" href="https://linkedin.com/in/0xPb/"> <ion-icon name="logo-linkedin"></ion-icon> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#csp">CSP</a>, <a class="tag" href="/tags/#xss">XSS</a>, <a class="tag" href="/tags/#part3">PART3</a> </span> </div> <h1 class="header-title" itemprop="headline">CSP-101 Part-3</h1> <div class="post-meta"> <time datetime="2023-12-03T01:00:00+07:00" itemprop="datePublished"> Dec 03, 2023 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Prasanth Bodepu</span> </span> <time hidden datetime="2023-12-03T16:49:47+07:00" itemprop="dateModified"> Dec 03, 2023 </time> <span hidden itemprop="publisher" itemtype="Person">Prasanth Bodepu</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><h3 id="other-csp-protections">Other CSP Protections</h3> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <h3 id="other-csp-protections"> <a href="#other-csp-protections" class="anchor-head"></a> Other CSP Protections </h3> <p><img src="/_posts/CSP-101/csp03.png" alt="csp03" /></p> <h3 id="faqs--misconfigurations"> <a href="#faqs--misconfigurations" class="anchor-head"></a> FAQs &amp; Misconfigurations </h3> <h3 id="stick-to-one-csp-header"> <a href="#stick-to-one-csp-header" class="anchor-head"></a> Stick to One CSP Header </h3> <ul> <li>It is recommended to use a singular CSP header to avoid conflicts and maintain consistency. Multiple headers can lead to a highly restrictive policy.</li> </ul> <h3 id="send-csp-header-in-the-http-response"> <a href="#send-csp-header-in-the-http-response" class="anchor-head"></a> Send CSP Header in the HTTP Response </h3> <ul> <li>Embed the CSP header in the HTTP response delivering the HTML content to effectively enforce the security policy.</li> </ul> <h3 id="avoid-script-src-unsafe-inline"> <a href="#avoid-script-src-unsafe-inline" class="anchor-head"></a> Avoid <code class="language-plaintext highlighter-rouge">script-src 'unsafe-inline'</code> </h3> <ul> <li>Refrain from using <code class="language-plaintext highlighter-rouge">script-src 'unsafe-inline'</code> as it undermines most CSP protections, allowing overly permissive sources like <code class="language-plaintext highlighter-rouge">https://</code>, <code class="language-plaintext highlighter-rouge">*</code>, and <code class="language-plaintext highlighter-rouge">data</code>.</li> </ul> <h3 id="include-default-src-object-src-base-uri-with-none-or-self"> <a href="#include-default-src-object-src-base-uri-with-none-or-self" class="anchor-head"></a> Include (<code class="language-plaintext highlighter-rouge">default-src</code>, <code class="language-plaintext highlighter-rouge">object-src</code>, <code class="language-plaintext highlighter-rouge">base-uri</code>) with <code class="language-plaintext highlighter-rouge">none</code> or <code class="language-plaintext highlighter-rouge">self</code> </h3> <ul> <li>Specify <code class="language-plaintext highlighter-rouge">default-src</code>, <code class="language-plaintext highlighter-rouge">object-src</code>, and <code class="language-plaintext highlighter-rouge">base-uri</code> in the CSP header with values set to either <code class="language-plaintext highlighter-rouge">none</code> or <code class="language-plaintext highlighter-rouge">self</code>. Preferably, use <code class="language-plaintext highlighter-rouge">none</code> and employ full paths to prevent loading potentially hazardous content.</li> </ul> <h3 id="utilize-full-paths-to-prevent-cdn-exploitation"> <a href="#utilize-full-paths-to-prevent-cdn-exploitation" class="anchor-head"></a> Utilize Full Paths to Prevent CDN Exploitation </h3> <ul> <li>When specifying content sources, use full paths to thwart the loading of malicious content. Exercise caution with CDNs that allow free hosting of GitHub projects, as attackers can exploit this to upload and include malicious JavaScript, bypassing the CSP.</li> </ul> <h3 id="implement-report-sample-on-script-srcstyle-src"> <a href="#implement-report-sample-on-script-srcstyle-src" class="anchor-head"></a> Implement <code class="language-plaintext highlighter-rouge">report-sample</code> on <code class="language-plaintext highlighter-rouge">script-src/style-src</code> </h3> <ul> <li>Ensure the usage of <code class="language-plaintext highlighter-rouge">report-sample</code> on the <code class="language-plaintext highlighter-rouge">script-src</code> and <code class="language-plaintext highlighter-rouge">style-src</code> directives in the CSP header. This facilitates accurate reporting of violations, enhancing the effectiveness of the security policy.</li> </ul> <h2 id="other-ways-to-deploy-csp"> <a href="#other-ways-to-deploy-csp" class="anchor-head"></a> Other ways to deploy CSP </h2> <ul> <li>CSPv3 includes <code class="language-plaintext highlighter-rouge">'unsafe-dynamic'</code>, which is a propagating trust model. When used with <code class="language-plaintext highlighter-rouge">'nonce-abc123'</code> allows nonce’d scripts to load any resource. <code class="language-plaintext highlighter-rouge">https://csp.withgoogle.com/docs/index.html</code></li> </ul> <h2 id="tools"> <a href="#tools" class="anchor-head"></a> Tools: </h2> <h3 id="automatic-policy-generators"> <a href="#automatic-policy-generators" class="anchor-head"></a> Automatic Policy Generators </h3> <ul> <li>https://csper.io/generator</li> <li>Laboratory (Content Security Policy / CSP Toolkit)</li> </ul> <h3 id="report-uri-endpoints"> <a href="#report-uri-endpoints" class="anchor-head"></a> Report-URI Endpoints </h3> <ul> <li>https://csper.io <ul> <li>Groups similar reports</li> <li>Classification</li> <li>Real-time monitoring</li> <li>Alerting on Suspicious reports / report spikes</li> </ul> </li> <li>Aggregators (Splunk, ELK, etc)</li> </ul> </div> </article> </main> <small class="post-updated-at">updated_at 03-12-2023</small> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/CSP-101-Part-2/" > <div class="nav-arrow">Previous</div> <span class="post-title">CSP-101 Part-2</span> </a> </nav> <footer class="footer"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css"> <!-- <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="javascript::void(0)">resume</a> --> <!-- <a class="footer_item" href="/feed.xml">rss</a> --> <span class="footer_item">&copy; 2023</span> <small class="footer_copyright"> <small class="text-muted mb-2"> <i class="fas fa-code"></i> with <i class="fa fa-heart" aria-hidden="false"></i> by <strong>Prasanth Bodepu</strong> </small> <br> <a class="social mx-1" href="mailto:prasanth.bodepu@gmail.com" style="color: rgb(108, 117, 125);" onmouseover="this.style.color='#db4437'" onmouseout="this.style.color='#6c757d'"> <i class="fas fa-envelope fa-1x"></i> </a> &nbsp;&nbsp; <a class="social mx-1" href="https://www.github.com/0xPb1" style="color: rgb(108, 117, 125);" onmouseover="this.style.color='#333333'" onmouseout="this.style.color='#6c757d'"> <i class="fab fa-github fa-1x"></i> </a> &nbsp;&nbsp; <a class="social mx-1" href="https://www.instagram.com/_0xpb" style="color: rgb(108, 117, 125);" onmouseover="this.style.color='#405de6'" onmouseout="this.style.color='#6c757d'"> <i class="fab fa-instagram fa-1x"></i> </a> &nbsp;&nbsp; <a class="social mx-1" href="https://www.linkedin.com/in/0xPb" style="color: #6c757d" onmouseover="this.style.color='#007bb5'" onmouseout="this.style.color='#6c757d'"> <i class="fab fa-linkedin-in fa-1x"></i> </a> &nbsp;&nbsp; <a class="social mx-1" href="https://www.twitter.com/_0xPb" style="color: #6c757d" onmouseover="this.style.color='#1da1f2'" onmouseout="this.style.color='#6c757d'"> <i class="fab fa-twitter fa-1x"></i> </a> </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
